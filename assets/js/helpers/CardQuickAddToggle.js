if(!window.cardQuickAddToggleBound){window.cardQuickAddToggleBound=!0;var withJsEndpoint=function(t,e){var n=t||e;return n.endsWith(".js")?n:n+".js"},getCart=function(){return fetch(withJsEndpoint(window.routes&&window.routes.cart_url,"/cart"),{method:"GET",credentials:"same-origin",headers:{Accept:"application/json"}}).then(function(t){if(!t.ok)throw new Error("Failed cart fetch");return t.json()})},refreshCartIconSection=function(){return fetch(window.location.pathname+"?sections=cart-icon-bubble",{method:"GET",credentials:"same-origin",headers:{Accept:"application/json"}}).then(function(t){if(!t.ok)throw new Error("Failed cart icon section fetch");return t.json()}).then(function(t){var e=t&&t["cart-icon-bubble"];if(e){var n=document.querySelectorAll("#cart-icon-bubble");n.length&&n.forEach(function(t){t.innerHTML=e})}})},addToCart=function(t,e){return fetch(withJsEndpoint(window.routes&&window.routes.cart_add_url,"/cart/add"),{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({id:t,quantity:e})}).then(function(t){if(!t.ok)throw new Error("Failed add");return t.json()})},changeCart=function(t,e){return fetch(withJsEndpoint(window.routes&&window.routes.cart_change_url,"/cart/change"),{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({id:t,quantity:e})}).then(function(t){if(!t.ok)throw new Error("Failed change");return t.json()})},updateCartBubble=function(t){document.querySelectorAll(".cart-count-bubble").forEach(function(e){if(!t||t<1)e.innerHTML="";else{var n=e.querySelector('span[aria-hidden="true"]');n||((n=document.createElement("span")).setAttribute("aria-hidden","true"),e.appendChild(n)),n.textContent=String(t);var r=e.querySelector(".visually-hidden");r||((r=document.createElement("span")).className="visually-hidden",e.appendChild(r)),r.textContent="Cart contains "+t+" items"}})},getVariantId=function(t){var e=t.dataset.cardVariantId;if(e)return e;var n=t.closest("form");if(!n)return null;var r=n.querySelector('input[name="id"]');return r?r.value:null},setPending=function(t,e){t.dataset.cardQuickAddPending=e?"true":"false",t.querySelectorAll(".js-card-quick-add-trigger, .js-card-quick-add-plus, .js-card-quick-add-minus").forEach(function(t){t.disabled=e})},syncSwitchesFromCart=function(t){var e={};(t.items||[]).forEach(function(t){e[String(t.variant_id)]=t.quantity}),document.querySelectorAll(".js-card-quick-add-switch").forEach(function(t){var n=getVariantId(t),r=t.querySelector(".js-card-quick-add-value");if(n&&r){var a=e[String(n)]||0;a>0?(r.textContent=String(a),t.classList.add("is-active")):(r.textContent="1",t.classList.remove("is-active"))}}),updateCartBubble(t.item_count||0)},refreshFromCart=function(){return getCart().then(function(t){return syncSwitchesFromCart(t),refreshCartIconSection().catch(function(){}).then(function(){return t})})};document.addEventListener("click",function(t){var e=t.target.closest(".js-card-quick-add-trigger");if(e){var n=e.closest(".js-card-quick-add-switch");if(!n||e.disabled)return;if(t.preventDefault(),t.stopPropagation(),"true"===n.dataset.cardQuickAddPending)return;var r=getVariantId(n);if(!r)return;return setPending(n,!0),void addToCart(r,1).then(function(){return n.classList.add("is-active"),refreshFromCart()}).catch(function(t){console.error("Card quick add failed:",t)}).finally(function(){setPending(n,!1)})}var a=t.target.closest(".js-card-quick-add-plus");if(a){var i=a.closest(".js-card-quick-add-switch");if(!i)return;if("true"===i.dataset.cardQuickAddPending)return;var c=getVariantId(i);if(!c)return;return setPending(i,!0),void addToCart(c,1).then(function(){return i.classList.add("is-active"),refreshFromCart()}).catch(function(t){console.error("Card quick add increment failed:",t)}).finally(function(){setPending(i,!1)})}var d=t.target.closest(".js-card-quick-add-minus");if(d){var o=d.closest(".js-card-quick-add-switch");if(o&&"true"!==o.dataset.cardQuickAddPending){var u=getVariantId(o);if(u){var s=o.querySelector(".js-card-quick-add-value");if(s){var l=(parseInt(s.textContent,10)||1)-1;setPending(o,!0),changeCart(u,Math.max(l,0)).then(function(){return refreshFromCart()}).catch(function(t){console.error("Card quick add decrement failed:",t)}).finally(function(){setPending(o,!1)})}}}}}),refreshFromCart().catch(function(){}),document.addEventListener("shopify:section:load",function(){refreshFromCart().catch(function(){})})}